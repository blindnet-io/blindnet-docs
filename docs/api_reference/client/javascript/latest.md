---
title: JavaScript client SDK v0.1.3
---

## Installation
Pick one of the following methods to install the blindnet SDK.

=== "npm"
    Run the following command in your terminal.
    ```console
    npm i -S @blindnet/sdk-javascript
    ```
=== "yarn"
    Run the following command in your terminal.
    ```console
    yarn add @blindnet/sdk-javascript
    ```
=== "umd"
    Download the [umd](https://irian.to/blogs/what-are-cjs-amd-umd-and-esm-in-javascript/){target=_blank} file and include it in your `HTML` file.  
    File can be downloaded [here](){target=_blank}.
    ```html
    <script src="blindnet.umd.js"></script>
    ```

## Imports
If the SDK was installed as an `npm` package, it is imported as

```js
import { Blindnet, util, error } from '@blindnet/sdk-javascript'
```

If it was imported as an `umd` package, use
```js
const { Blindnet, util, error } = blindnet
```

The api is encapsulated in the `Blindnet` class.

## Initialization
Blindnet SDK must be initialized before you can use it (with the exception of the [secret derivation]() method).

Initialization is done with the `init` method.
  
```typescript
static function init(token: string, endpoint?: string): Blindnet
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
token | string | true | Authentication token generated by server SDK. For more information, click [here](){target=_blank}.
endpoint | string | false | Endpoint of the blindnet server. Default value is `https://api.blindnet.io`. For testing, use `https://test.blindnet.io`

#### Return type
`Blindnet`

Instance which you use to call SDK methods.  
```js linenums="1"
const blindnet = Blindnet.init(token)
blindnet.connect(secret)
```

## Refreshing the session
After the token expires, [AuthenticationError](){target=_blank} will be thrown on api calls.
[Generate a new token](){target=_blank} using server SDK and call `refreshToken`.

```typescript
function refreshToken(token: string): void
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
token | string | true | Authentication token generated by server SDK. For more information, click [here](){target=_blank}.


#### Return type
`void`

## Logging-in
A user must be logged-into to blindnet before using any Blindnet api methods (with the exception of encrypting).
The user can both register and log-in with the method connect.

```typescript
function connect(secret: string): Promise<void>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
secret | string | true | A secret value used to encrypt and decrypt user’s keys. Usually, should be derived from user’s password using the [deriveSecrets]() method

#### Return type
`Promise<void>`

The operation succeeded if an exception wasn’t thrown.

#### Errors
type | description
---- | -----------
AuthenticationError | Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server..
PasswordError | A bad secret has been provided. Could not decrypt the user’s keys.

### Deriving secrets
User’s password is a sensitive data. As it can be used both to log-into your application and to encrypt user’s keys in blindnet, it should be splitted into two parts and each part should be used for different purposes.

```typescript
function deriveSecrets(password: string): Promise<{ blindnetSecret: string, appSecret: string }>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
password | string | true | A value generated by a user. It can be the user's password or e.g. answer to a security question.

#### Return type
`Promise<{ blindnetSecret: string, appSecret: string }>`

If a user's log-in password is used as an input parameter, use `blindnetSecret` in the [connect]() method and `appSecret` to log-into your application.

## Logging-out
After the user is logged out of your app, following method should be called to clean the user’s keys from the browser

```typescript
Blindnet.disconnect()
```

## Changing login secret
If an app password is used to log-in users into blindnet, make sure to call this method after a user changes the password. Remember to call [deriveSecrets]().

```typescript
function changeSecret(newSecret: string, oldSecret?: string): Promise<void>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
newSecret | string | true | A new secret used to encrypt user’s keys.
oldSecret | string | false | Current secret used to encrypt user’s keys. If the user is currently not logged into blindnet, it should be provided into the method.

#### Return type
`Promise<void>`

The operation succeeded if an exception wasn’t thrown.

#### Errors
type | description
---- | -----------
AuthenticationError | Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server.
PasswordError | Bad `oldSecret` is provided.
UserNotInitializedError | A user is not logged into blindnet and `oldSecret` is not provided.
UserNotFoundError | A user was not registered or was deleted from blindnet.

## Encrypting

```typescript
function encrypt(data: string | File | ArrayBuffer | Uint8Array, metadata?: { [key: string]: any }): Promise<{ dataId: string, encryptedData: ArrayBuffer }>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
data | string \| File \| ArrayBuffer \| Uint8Array | true | Data to encrypt. Can be of any type specified.
metadata | { [key: string]: any } | false | Metadata in JSON format.

#### Return type
`Promise<{ dataId: string, encryptedData: ArrayBuffer }>`

`dataId` can be used to delete a file using the server SDK.  
`encryptedData` can be encoded using [toBase64]() and [toHex]() methods.

#### Errors
type | description
---- | -----------
AuthenticationError | Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server.
BadFormatError | Either provided data or metadata has the wrong type.
NotEncryptabeError | There are no users to encrypt the data to.

### Encrypting values
This method encrypts only the values of a provided JavaScript object.

```typescript
function encryptValues(data: { [key: string]: string }, noPrefix?: boolean): Promise<{ dataId: string, encryptedData: { [key: string]: string } }>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
data | { [key: string]: string } | true | An object whose values to encrypt. Both object’s keys and values should be strings.

#### Return type
`Promise<{ dataId: string, encryptedData: { [key: string]: string } }>`

`dataId` can be used to delete a file using the server SDK.  
`encryptedData` is a JavaScript object with encrypted values, encoded to hex encoding. Object keys are left in plain text.

#### Errors

type | description
---- | -----------
AuthenticationError | Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server.
BadFormatError | Provided data is not the expected type.
NotEncryptabeError | There are no users to encrypt the data to.

## Decrypting

```typescript
function decrypt(encryptedData: ArrayBuffer | Uint8Array): Promise<{ data: string | File | Bytes, metadata: { dataType: DataType, [key: string]: any; } }>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
encryptedData | ArrayBuffer \| Uint8Array | true | Encrypted data to decrypt (result of [encrypt]() method). If it was encoded, it can be decoded using [fromBase64]() or [fromHex]().

#### Return type
`Promise<{ data: string | File | ArrayBuffer | Uint8Array, metadata: { dataType: DataType, [key: string]: any; } }>`

`type DataType = { type: 'STRING' } | { type: 'FILE', name: string } | { type: 'BYTES' }`

`data` is in format it was originally provided to the [encrypt]() method. If not known, it can be inspected from the `dataType` property of the metadata.

#### Errors

type | description
---- | -----------
AuthenticationError | Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server.
UserNotInitializedError | A user is not logged into blindnet.
NoAccessError | A user has no access to encrypted data.
EncryptionError | Data could not be decrypted. Either due to wrong data format or the keys were deleted from blindnet.

### Decrypting values
This method decrypts the encrypted values of an object encrypted using [encryptValues]() method.

```typescript
function decryptValues(encryptedData: { [key: string]: string }): Promise<{ data: { [key: string]: string } }>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
encryptedData | { [key: string]: string } | true | An object whose values are encrypted. Result from the [encryptValues]() method.

#### Return type
`Promise<{ data: { [key: string]: string } }>`

`data` is the original data passed to [encryptValues]() method.

#### Errors
type | description
---- | -----------
AuthenticationError | Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server
UserNotInitializedError | A user is not logged into blindnet.
NoAccessError | A user has no access to encrypted data.
EncryptionError | Data could not be decrypted. Either due to wrong data format or the keys were deleted from blindnet. 

## Giving access to a user
A user can give access to encrypted data (to which the user already has access to) to another user.

```typescript
function giveAccess(userId: string): Promise<void>
```

#### Parameters
name | type | required | description
---- | ---- | -------- | -----------
userId | string | true | Id of a user to whom access is being given.

#### Return type
`Promise<void>`

The operation succeeded if an exception wasn’t thrown.

#### Errors
type | description
---- | -----------
AuthenticationError Token has expired or is invalid. Generate a new token and call [refreshToken]().
BlindnetServiceError | Error on blindnet server.
UserNotFoundError | A user whose id was provided as a parameter was not registered or was deleted from blindnet.

## Helper methods
Blindnet SDK provides the methods to encode and decode encrypted data, so it can be easily transferred and stored.

Helper methods can be imported as

```javascript
import { util } from '@blindnet/sdk-javascript'
const { toBase64, fromBase64, toHex, fromHex } = util
```

### Encoding
Result of the encrypt method is used as a parameter in the following methods:

#### Encode to base64 string
```typescript
function toBase64(encryptedData: ArrayBuffer): string
```

#### Encode to hexadecimal string
```typescript
function toHex(encryptedData: ArrayBuffer): string
```

### Decoding
A `base64` or `hex` encoded string can be decoded into `ArrayBuffer` and passed to decrypt method using the following methods:

#### Decode from base64 string
```typescript
function fromBase64(encoded: string): ArrayBuffer
```

#### Decode from hexadecimal string
```typescript
function fromHex(encoded: string): ArrayBuffer
```
